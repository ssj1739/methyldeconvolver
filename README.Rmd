---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# methyldeconvolveR

<!-- badges: start -->
<!-- badges: end -->

The `methyldeconvolveR` R package allows users to perform cell-type deconvolution using whole-genome bisulfite sequencing at the read-level.

## Installation

You can install the development version of methyldeconvolveR from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("ssj1739/methyldeconvolver")
```

## Example

This is a basic example which shows you how to perform cell-type deconvolution using `methyldeconvolveR`:

```{r example}
library(methyldeconvolveR)
```

The reference atlas from McDeed et al. is included in the package, and can be
accessed with the `use_reference` function as shown here:

```{r}
ref <- use_reference()

# A quick glimpse at the marker regions included in the reference
head(ref$marker)

# And a glimpse at the learned reference parameters
head(ref$beta_celltype_fits$breastbasal)
```

Reference parameters were learned using PAT files from each cell type, as shown in the following function (not run).
New references can be learned given a set of marker regions and PAT files generated by `wgbstools`.

```{r, eval = F}
### NOT RUN:
newref <- learn_reference(marker.file = "markers.bed",
                pat.dir = "/path/to/directory/",
                save.output = T, verbose = T, 
                n_threads = 8, split_reads = F)
```

Cell type deconvolution can be performed by the following (not run):

```{r, eval = F}
results <- deconvolute_sample(sample_pat = "path/to/sample.pat.gz", 
                   reference = ref, quiet = F, 
                   num_of_inits = 100, n_threads = 8)
```


